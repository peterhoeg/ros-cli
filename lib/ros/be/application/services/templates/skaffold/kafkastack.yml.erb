--- 
apiVersion: <%= @service.skaffold_version %>
kind: Config
deploy:
  helm:
    releases:
      - name: kafka
        chartPath: incubator/kafka
        skipBuildDependencies: true
        overrides:
          imageTag: 5.3.0
          replicas: 1
          fullnameOverride: kafka
          resources:
            limits:
              cpu: 200m
              memory: 1536Mi
            requests:
              cpu: 100m
              memory: 1024Mi
          prometheus:
            jmx:
              enabled: true
            kafka:
              enabled: true
          persistence:
            enabled: true
            size: 50Gi
          zookeeper:
            enabled: false
            url: "zookeeper"            
      - name: zookeeper 
        chartPath: <%= @service.chart_path %>/kafkastack/cp-helm-charts/charts/cp-zookeeper
        skipBuildDependencies: true
        overrides:
          imageTag: 5.3.0
          servers: 1  
          fullnameOverride: zookeeper                  
          resources:
            limits:
              cpu: 1
              memory: 1.2Gi
            requests:
              cpu: 100m
              memory: 1Gi
          persistence:
            enabled: true
            size: 5Gi
      - name: kafka-schema-registry
        chartPath: <%= @service.chart_path %>/kafkastack/cp-helm-charts/charts/cp-schema-registry
        skipBuildDependencies: true        
        overrides:
          imageTag: 5.3.0  
          replicaCount: 1          
          fullnameOverride: kafka-schema-registry          
          kafka:
            bootstrapServers: "PLAINTEXT://kafka-headless:9092"
          heapOptions: "-Xms1024M -Xmx1024M"
          resources:
            limits:
             cpu: 1
             memory: 1.5Gi
            requests:
             cpu: 200m
             memory: 1Gi



