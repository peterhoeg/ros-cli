#!/usr/bin/env ruby

if ARGV[0]&.eql? '-T'
  res = %x(rake -T #{ARGV[1]})
  STDOUT.puts res.gsub(/^rake/, 'ros').gsub("\nrake", "\nros")
elsif ARGV[0]&.include? ':'
  require 'rake'
  tasks = ARGV.each_with_object([]) { |arg, tasks| tasks.append(arg) if arg.index(':') }
  args = ARGV.each_with_object([]) { |arg, args| args.append(arg) unless arg.index(':') }
  Rake.load_rakefile('Rakefile') if File.exists?('Rakefile')
  tasks.each { |task| Rake::Task[task].invoke(args) }
else
  require 'bundler/setup'
  require 'ros'
=begin
  dir = Dir.pwd.split('/').last
  arg = ARGV[0]
  if %w(be fe data).include?(dir)
    require "ros/cli/#{dir}"
    Ros.const_get("#{dir.capitalize}::Cli").start
  elsif %w(be fe data).include?(arg)
    require "ros/cli/#{arg}"
    ARGV.shift
    Ros.const_get("#{arg.capitalize}::Cli").start
  else
    require 'ros/cli'
    Ros::Cli.start
  end
=end
  require 'ros/cli/be'
  Ros::Be::Cli.start
end
